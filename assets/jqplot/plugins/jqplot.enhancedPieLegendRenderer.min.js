(function($){$.jqplot.EnhancedPieLegendRenderer=function(){$.jqplot.TableLegendRenderer.call(this);};$.jqplot.EnhancedPieLegendRenderer.prototype=new $.jqplot.TableLegendRenderer();$.jqplot.EnhancedPieLegendRenderer.prototype.constructor=$.jqplot.EnhancedPieLegendRenderer;$.jqplot.EnhancedPieLegendRenderer.prototype.init=function(options){this.numberRows=null;this.numberColumns=null;this.seriesToggle='normal';this.seriesToggleReplot=false;this.disableIEFading=true;this.toolTips=[];$.extend(true,this,options);if(this.seriesToggle){$.jqplot.postDrawHooks.push(postDraw);}};$.jqplot.EnhancedPieLegendRenderer.prototype.draw=function(offsets,plot){var legend=this;if(this.show){var series=this._series;var s;var ss='position:absolute;';ss+=(this.background)?'background:'+this.background+';':'';ss+=(this.border)?'border:'+this.border+';':'';ss+=(this.fontSize)?'font-size:'+this.fontSize+';':'';ss+=(this.fontFamily)?'font-family:'+this.fontFamily+';':'';ss+=(this.textColor)?'color:'+this.textColor+';':'';ss+=(this.marginTop!=null)?'margin-top:'+this.marginTop+';':'';ss+=(this.marginBottom!=null)?'margin-bottom:'+this.marginBottom+';':'';ss+=(this.marginLeft!=null)?'margin-left:'+this.marginLeft+';':'';ss+=(this.marginRight!=null)?'margin-right:'+this.marginRight+';':'';this._elem=$('<table class="jqplot-table-legend" style="'+ss+'"></table>');if(this.seriesToggle){this._elem.css('z-index','3');}
var pad=false,reverse=false,nr,nc;var s=series[0];var slen=s.data.length;var colorGenerator=new $.jqplot.ColorGenerator(s.seriesColors);if(this.numberRows){nr=this.numberRows;if(!this.numberColumns){nc=Math.ceil(slen/nr);}
else{nc=this.numberColumns;}}
else if(this.numberColumns){nc=this.numberColumns;nr=Math.ceil(slen/this.numberColumns);}
else{nr=slen;nc=1;}
var i,j,tr,td1,td2,lt,rs,div,div0,div1;var idx=0;for(i=series.length-1;i>=0;i--){if(nc==1&&series[i]._stack||series[i].renderer.constructor==$.jqplot.BezierCurveRenderer){reverse=true;}}
for(i=0;i<nr;i++){tr=$(document.createElement('tr'));tr.addClass('jqplot-table-legend');if(reverse){tr.prependTo(this._elem);}
else{tr.appendTo(this._elem);}
for(j=0;j<nc;j++){if(idx<slen){lt=this.labels[idx]||s.data[idx][0].toString();tt=this.toolTips[idx];if(lt){var color=colorGenerator.next();if(!reverse){if(i>0){pad=true;}
else{pad=false;}}
else{if(i==nr-1){pad=false;}
else{pad=true;}}
rs=(pad)?this.rowSpacing:'0';td1=$(document.createElement('td'));td1.addClass('jqplot-table-legend jqplot-table-legend-swatch');td1.css({textAlign:'center',paddingTop:rs});div0=$(document.createElement('div'));div0.addClass('jqplot-table-legend-swatch-outline');if(tt!==undefined){div0.attr("title",tt);}
div1=$(document.createElement('div'));div1.addClass('jqplot-table-legend-swatch');div1.css({backgroundColor:color,borderColor:color});td1.append(div0.append(div1));td2=$(document.createElement('td'));td2.addClass('jqplot-table-legend jqplot-table-legend-label');td2.css('paddingTop',rs);if(tt!==undefined){td2.attr("title",tt);}
if(this.escapeHtml){td2.text(lt);}
else{td2.html(lt);}
if(reverse){if(this.showLabels){td2.prependTo(tr);}
if(this.showSwatches){td1.prependTo(tr);}}
else{if(this.showSwatches){td1.appendTo(tr);}
if(this.showLabels){td2.appendTo(tr);}}
if(this.seriesToggle){var speed;if(typeof(this.seriesToggle)==='string'||typeof(this.seriesToggle)==='number'){if(!$.jqplot.use_excanvas||!this.disableIEFading){speed=this.seriesToggle;}}
if(this.showSwatches){td1.bind('click',{series:s,index:idx,speed:speed,plot:plot,replot:this.seriesToggleReplot},handleToggle);td1.addClass('jqplot-seriesToggle');}
if(this.showLabels){td2.bind('click',{series:s,index:idx,speed:speed,plot:plot,replot:this.seriesToggleReplot},handleToggle);td2.addClass('jqplot-seriesToggle');}
if(s.showSlice[idx]===false&&s.showLabel){td1.addClass('jqplot-series-hidden');td2.addClass('jqplot-series-hidden');}}
pad=true;}}
idx++;}
td1=td2=div0=div1=null;}}
return this._elem;};var handleToggle=function(ev){var d=ev.data,replot=d.replot,plot=d.plot,idx=d.index;d.series.showSlice[idx]=(d.series.showSlice[idx]===false)?true:false;var opts={};if($.isPlainObject(replot)){$.extend(true,opts,replot);}
plot.replot(opts);};var postDraw=function(){if(this.legend.renderer.constructor==$.jqplot.EnhancedPieLegendRenderer&&this.legend.seriesToggle){var e=this.legend._elem.detach();this.eventCanvas._elem.after(e);}};})(jQuery);